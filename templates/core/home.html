{% extends 'base.html' %}

{% block content %}
<!-- Hero Section with Integrated Countdown -->
<div class="hero-professional" style="padding: var(--space-xl) 0 var(--space-2xl) 0;">
    <div class="container-professional">
        <div class="hero-grid">
            <!-- Left: Content -->
            <div class="hero-content">
                <h1 class="hero-title" style="text-align: left; font-size: var(--font-size-5xl);">
                    MMT Budget Day<br>Response Suite
                </h1>
                <p class="hero-subtitle" style="text-align: left; margin-left: 0; margin-right: 0;">
                    Track budget myths in real-time, crowdsource fact-checks, hold media accountable, and generate comprehensive MMT rebuttals for the UK Autumn Statement 2025.
                </p>
                <div class="hero-buttons">
                    <a href="{% url 'factcheck:submit' %}" class="btn-primary">Submit Fact-Check</a>
                    <a href="{% url 'rebuttal:latest' %}" class="btn-secondary">View Latest Rebuttal</a>
                </div>
            </div>

            <!-- Right: Countdown -->
            <div class="hero-countdown">
                <div class="countdown-box">
                    <div class="countdown-label">Autumn Statement</div>
                    <div class="countdown-date">26 November 2025</div>
                    <div class="countdown-time">12:30 PM UK Time</div>
                    <div class="countdown-divider"></div>
                    <div class="countdown-timer-container">
                        <div class="countdown-unit">
                            <span class="countdown-value" id="countdown-days">--</span>
                            <span class="countdown-unit-label">Days</span>
                        </div>
                        <div class="countdown-separator">:</div>
                        <div class="countdown-unit">
                            <span class="countdown-value" id="countdown-hours">--</span>
                            <span class="countdown-unit-label">Hours</span>
                        </div>
                        <div class="countdown-separator">:</div>
                        <div class="countdown-unit">
                            <span class="countdown-value" id="countdown-minutes">--</span>
                            <span class="countdown-unit-label">Mins</span>
                        </div>
                        <div class="countdown-separator">:</div>
                        <div class="countdown-unit">
                            <span class="countdown-value" id="countdown-seconds">--</span>
                            <span class="countdown-unit-label">Secs</span>
                        </div>
                    </div>
                    <div id="countdown-status" class="countdown-status"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Feature Cards -->
<div style="padding: var(--space-xl) 0;">
    <div class="container-professional">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
            <!-- Bingo -->
            <div class="card card-interactive">
                <div class="feature-icon">ðŸŽ¯</div>
                <h3 class="feature-title">Budget Bingo</h3>
                <p class="feature-desc">Track and mark budget myths in real-time. Compete with others!</p>
                <a href="{% url 'bingo:home' %}" class="btn-secondary">Play Bingo</a>
            </div>

            <!-- Fact-Check -->
            <div class="card card-interactive">
                <div class="feature-icon">âœ“</div>
                <h3 class="feature-title">Fact-Check Platform</h3>
                <p class="feature-desc">Submit claims for AI-powered fact-checking with MMT perspective.</p>
                <a href="{% url 'factcheck:submit' %}" class="btn-secondary">Submit Claim</a>
            </div>

            <!-- Rebuttal -->
            <div class="card card-interactive">
                <div class="feature-icon">ðŸ“„</div>
                <h3 class="feature-title">Comprehensive Rebuttal</h3>
                <p class="feature-desc">AI-generated comprehensive analysis and rebuttal document.</p>
                <a href="{% url 'rebuttal:latest' %}" class="btn-secondary">View Rebuttal</a>
            </div>

            <!-- Media Complaints -->
            <div class="card card-interactive">
                <div class="feature-icon">ðŸ“¢</div>
                <h3 class="feature-title">Media Complaints</h3>
                <p class="feature-desc">Report misinformation and generate AI-powered complaint letters.</p>
                <a href="{% url 'media_complaints:home' %}" class="btn-secondary">File Complaint</a>
            </div>
        </div>
    </div>
</div>

<!-- Stats Section -->
<div style="background: var(--color-surface); padding: var(--space-xl) 0 var(--space-2xl) 0;">
    <div class="container-professional">
        <h2 class="section-title">Live Statistics</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div class="stat-card">
                <span class="stat-number">{{ total_bingo_cards }}</span>
                <span class="stat-label">Bingo Cards Generated</span>
            </div>
            <div class="stat-card">
                <span class="stat-number">{{ total_factchecks }}</span>
                <span class="stat-label">Claims Fact-Checked</span>
            </div>
            <div class="stat-card">
                <span class="stat-number">{{ total_complaints|default:"0" }}</span>
                <span class="stat-label">Complaints Filed</span>
            </div>
        </div>
    </div>
</div>

<style>
/* Hero Grid Layout */
.hero-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-2xl);
    align-items: center;
}

.hero-content {
    text-align: left;
}

.hero-buttons {
    display: flex;
    gap: var(--space-md);
    flex-wrap: wrap;
}

/* Countdown Box */
.hero-countdown {
    display: flex;
    justify-content: center;
}

.countdown-box {
    background: white;
    border: 1px solid var(--color-border);
    border-radius: var(--radius-xl);
    padding: var(--space-xl);
    text-align: center;
    box-shadow: var(--shadow-lg);
    min-width: 320px;
}

.countdown-label {
    font-size: var(--font-size-sm);
    font-weight: 600;
    color: var(--color-text-tertiary);
    text-transform: uppercase;
    letter-spacing: 0.1em;
    margin-bottom: var(--space-xs);
}

.countdown-date {
    font-size: var(--font-size-2xl);
    font-weight: 700;
    color: var(--color-text-primary);
    margin-bottom: var(--space-xs);
}

.countdown-time {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
    margin-bottom: var(--space-md);
}

.countdown-divider {
    height: 1px;
    background: var(--color-border);
    margin: var(--space-md) 0;
}

.countdown-timer-container {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    gap: var(--space-xs);
}

.countdown-unit {
    display: flex;
    flex-direction: column;
    align-items: center;
    min-width: 50px;
}

.countdown-value {
    font-size: var(--font-size-3xl);
    font-weight: 700;
    color: var(--color-text-primary);
    font-variant-numeric: tabular-nums;
    line-height: 1;
}

.countdown-unit-label {
    font-size: var(--font-size-xs);
    color: var(--color-text-tertiary);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-top: var(--space-xs);
}

.countdown-separator {
    font-size: var(--font-size-2xl);
    font-weight: 700;
    color: var(--color-text-tertiary);
    line-height: 1;
    padding-top: 2px;
}

.countdown-status {
    margin-top: var(--space-md);
    font-size: var(--font-size-lg);
    font-weight: 600;
    color: var(--color-success);
}

.countdown-status.live {
    color: var(--color-error);
    animation: pulse 2s ease-in-out infinite;
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.6; }
}

/* Feature Cards */
.feature-icon {
    font-size: 2rem;
    margin-bottom: var(--space-sm);
}

.feature-title {
    font-size: var(--font-size-lg);
    font-weight: 600;
    color: var(--color-text-primary);
    margin-bottom: var(--space-sm);
}

.feature-desc {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
    line-height: 1.5;
    margin-bottom: var(--space-md);
}

/* Section Title */
.section-title {
    text-align: center;
    font-size: var(--font-size-2xl);
    color: var(--color-text-primary);
    margin-bottom: var(--space-xl);
}

/* Responsive */
@media (max-width: 900px) {
    .hero-grid {
        grid-template-columns: 1fr;
        gap: var(--space-xl);
    }

    .hero-content {
        text-align: center;
    }

    .hero-content .hero-title {
        text-align: center;
    }

    .hero-content .hero-subtitle {
        text-align: center;
        margin-left: auto;
        margin-right: auto;
    }

    .hero-buttons {
        justify-content: center;
    }

    .countdown-box {
        min-width: auto;
        width: 100%;
        max-width: 360px;
    }
}

@media (max-width: 480px) {
    .countdown-timer-container {
        gap: 2px;
    }

    .countdown-unit {
        min-width: 40px;
    }

    .countdown-value {
        font-size: var(--font-size-2xl);
    }

    .countdown-separator {
        font-size: var(--font-size-xl);
    }
}
</style>

<script>
function updateCountdown() {
    // Budget Date: November 26, 2025, 12:30 PM UK time
    const budgetDate = new Date('2025-11-26T12:30:00+00:00');
    const now = new Date();
    const diff = budgetDate - now;

    const daysEl = document.getElementById('countdown-days');
    const hoursEl = document.getElementById('countdown-hours');
    const minutesEl = document.getElementById('countdown-minutes');
    const secondsEl = document.getElementById('countdown-seconds');
    const statusEl = document.getElementById('countdown-status');

    if (diff <= 0) {
        // Budget is happening or has passed
        daysEl.textContent = '00';
        hoursEl.textContent = '00';
        minutesEl.textContent = '00';
        secondsEl.textContent = '00';
        statusEl.textContent = 'ðŸ”´ LIVE NOW';
        statusEl.classList.add('live');
        return;
    }

    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((diff % (1000 * 60)) / 1000);

    // Pad with zeros
    daysEl.textContent = String(days).padStart(2, '0');
    hoursEl.textContent = String(hours).padStart(2, '0');
    minutesEl.textContent = String(minutes).padStart(2, '0');
    secondsEl.textContent = String(seconds).padStart(2, '0');

    // Update status based on time remaining
    if (days === 0 && hours < 1) {
        statusEl.textContent = 'Starting Soon!';
        statusEl.style.color = 'var(--color-warning)';
    } else if (days === 0) {
        statusEl.textContent = 'Today!';
        statusEl.style.color = 'var(--color-success)';
    } else {
        statusEl.textContent = '';
    }
}

// Update countdown immediately and then every second
updateCountdown();
setInterval(updateCountdown, 1000);
</script>
{% endblock %}
